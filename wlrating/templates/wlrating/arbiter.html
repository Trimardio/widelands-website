{% extends "wlrating/base.html" %}
{% comment %}
   vim:ft=htmldjango
{% endcomment %}

{% block content_header %}
<h1>Widelands players rating</h1>
{% endblock %}

{% load static %}

{% block content_main %}
<script src="{% static 'js/arbiter.js' %}" type="text/javascript"></script>
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function(){ 
        setAddPlayerBtn()
    }, false);
</script>

<div class="blogEntry post">
    <table id="arbiter-table"  cellspacing="0" cellpadding="0">
        <tr>
            <th>Start date</th>
            <th>Type of game</th> 
            <th>Map</th>
            <th>Players</th>
            <th>Winner team</th>
            <th>Submitted by</th>
            <th>link</th>
            <th>Action</th>
        </tr>
        {% for game in game_list %}
        <tr>
            <tr>
                <td>{{ game.start_date }}</td>
                <td>{{ game.game_type }}</td>
                <td>{{ game.game_map }}</td>
                <td  class="table_inside_table" >
                    <table >
                        <tr>
                            <th>Player</th>
                            <th>Tribe</th> 
                            <th>Team</th>
                        </tr>
                        {% for player in game.players %}
                        <tr>
                            <td>{{ player.username }}</td>
                            <td>{{ player.tribe }}</td>
                            <td>{{ player.team }}</td>
                        </tr>
                        {% endfor %}
                    </table>
                </td>
                <td>{{ game.win_team }}</td>
                <td>{{ game.submitter }}</td>
                <td></td>
                <td>
                    <a href="{% url 'remove_btn' game.game_id  %}"><button>Remove</button></a>
                </td>
            </tr>
        </tr>
        {% endfor %}
        <form method="post" action="/rating/arbiter/">    
            <tr>
                <td><input type="text" name="start_date"></td>
                <td><input type="text" name="game_type"></td> 
                <td><input type="text" name="game_map"></td>
                <td class="table_inside_table">
                    <table>
                        <tbody id="add_player_table">
                            <tr>
                                <th>Player</th>
                                <th>Tribe</th> 
                                <th>Team</th>
                                <th><button type="button" id="add_player_btn">Add</button></th>
                            </tr>
                            {% for i in '01234567'|make_list %}
                            <tr {% if forloop.counter > 2 %} class="to_hide" {% endif %}>
                                <td><input type="text" name="player_{{ i }}"></td>
                                <td><input type="text" name="tribe_{{ i }}"></td>
                                <td><input type="text" name="team_{{ i }}"></td>
                                <td><button type="button" class="remove_player_btn">Remove</button></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </td>
                <td><input type="text" name="result"></td>
                <td><input type="text" name="submitter"></td>
                <td><input type="text" name="link"></td>
                <td><input type="submit" value="Add game"></td>
                {% csrf_token %}
                
            </tr>
        </form>
    </table>
    <a href="{% url 'calculate_scores' %}" ><button>Calculate scores</button></a>
    <a href="{% url 'add_test_data' %}" ><button>Add test data</button></a>
</div>
{% endblock %}

